---
_sg_meta:
    type: "roles"
    config_version: 2

#allow empty roles, also in rest api
#grants no perms
sg_empty:
  cluster_permissions: []
  index_permissions: []
  tenant_permissions: []


sg_all_access:
  reserved: true
  hidden: true
  description: "..."
  cluster_permissions:
    - UNLIMITED
  index_permissions:
    - index_patterns: 
        - '*'
        - '/abc/'
      allowed_actions:
        - UNLIMITED
      fls:
        - field1
        - field2
      dls: |
              thequery
      masked_fields:
        - field3
        - field4
    - index_patterns: 
        - 'abc'
      allowed_actions:
        - indices:/read/*
      fls:
        - field3
        - field4
      dls: |
              anotherquery
      masked_fields:
        - field88
        - field99 
  tenant_permissions:
    - tenant_patterns:
        - my*_tenant
        - /regular/
        - _GLOBAL_?
        - _PRIVATE_?
      allowed_actions: 
        - kibana:saved_objects/visualizations/read
        - kibana:saved_objects/dashboards/delete
    - tenant_patterns:
        - other_tenant
        - '*xxx?'
      allowed_actions: 
        - kibana:saved_objects/visualizations/write
        - kibana:saved_objects/dashboards/*



sg_kibana_user:
  reserved: true
  description: "..."
  cluster_permissions:
    - INDICES_MONITOR
    - CLUSTER_COMPOSITE_OPS
  index_permissions:
    - index_patterns: #or
        - '.kibana'
        - '.kibana-6'
        - '.kibana_*'
      allowed_actions:
        - MANAGE
        - INDEX
        - READ
        - DELETE
    - index_patterns: 
        - '.tasks'
      allowed_actions:
        - INDICES_ALL
    - index_patterns: 
        - '.management-beats'
      allowed_actions:
        - INDICES_ALL        
    - index_patterns: 
        - '*'
      allowed_actions:
        - indices:data/read/field_caps*
        - indices:data/read/xpack/rollup*
        - indices:admin/mappings/get*
        - indices:admin/get
.with.dots:
  reserved: true
  description: "..."
  index_permissions:
    - index_patterns: 
        - '${user.name}'
      allowed_actions:
        - '*'
  tenants:
    t1: RO
    .ten.t2: RW